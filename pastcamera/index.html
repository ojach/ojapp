<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<!-- ============================= -->
<!--   PastCamera SEO / OGP å®Œå…¨ç‰ˆ   -->
<!-- ============================= -->

<title>PastCameraï½œã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡ãƒ»ãƒ•ã‚£ãƒ«ãƒ ãƒ»ãƒ‡ã‚¸ã‚«ãƒ¡é¢¨ã«åŠ å·¥ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«</title>

<meta name="description" content="PastCameraã¯å†™çœŸã‚’â€œæ˜”ã®ã‚«ãƒ¡ãƒ©ã§æ’®ã£ãŸã‚ˆã†ãªå†™ã‚Šâ€ã«åŠ å·¥ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚ã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡ã€ãƒ•ã‚£ãƒ«ãƒ ã€ãƒ‡ã‚¸ã‚«ãƒ¡ã€åˆæœŸã‚¹ãƒãƒ›ã®4ç¨®é¡ã‹ã‚‰é¸ã¶ã ã‘ã€‚ã‚¢ãƒ—ãƒªä¸è¦ã§ç°¡å˜ã«ãƒ¬ãƒˆãƒ­å†™çœŸã‚’ä½œã‚Œã¾ã™ã€‚">

<!-- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆä»Šã¯ãã“ã¾ã§é‡è¦ã˜ã‚ƒãªã„ã‘ã©ä¸€å¿œï¼‰ -->
<meta name="keywords" content="ã‚¬ãƒ©ã‚±ãƒ¼ å†™çœŸ, ãƒ•ã‚£ãƒ«ãƒ é¢¨ åŠ å·¥, ãƒ‡ã‚¸ã‚«ãƒ¡é¢¨, ã‚¬ãƒ©ã‚±ãƒ¼é¢¨, ãƒ¬ãƒˆãƒ­å†™çœŸ, å†™çœŸåŠ å·¥ ç„¡æ–™, PastCamera, OJapp">

<!-- SNS å…±æœ‰ç”¨ OGP -->
<meta property="og:title" content="PastCameraï½œå†™çœŸã‚’ã‚¬ãƒ©ã‚±ãƒ¼ãƒ»ãƒ•ã‚£ãƒ«ãƒ ãƒ»ãƒ‡ã‚¸ã‚«ãƒ¡é¢¨ã«åŠ å·¥ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«">
<meta property="og:description" content="å†™çœŸã‚’â€œæ˜”ã®ã‚«ãƒ¡ãƒ©ã§æ’®ã£ãŸã‚ˆã†ãªå†™ã‚Šâ€ã«å¤‰æ›ã€‚ã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡ã€ãƒ•ã‚£ãƒ«ãƒ ã€ãƒ‡ã‚¸ã‚«ãƒ¡ã€åˆæœŸã‚¹ãƒãƒ›ã®4ç¨®é¡ã‚’ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—ã§åŠ å·¥ã§ãã¾ã™ã€‚ç„¡æ–™ãƒ»ç™»éŒ²ä¸è¦ã€‚">
<meta property="og:image" content="https://ojapp.app/og/pastcamera-og.jpg">
<meta property="og:url" content="https://ojapp.app/pastcamera/">
<meta property="og:type" content="website">

<!-- Twitterã‚«ãƒ¼ãƒ‰ -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="PastCameraï½œã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡ãƒ»ãƒ•ã‚£ãƒ«ãƒ ãƒ»ãƒ‡ã‚¸ã‚«ãƒ¡é¢¨ã«åŠ å·¥ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«">
<meta name="twitter:description" content="å†™çœŸã‚’â€œæ˜”ã®ã‚«ãƒ¡ãƒ©ã®å†™ã‚Šâ€ã«å¤‰æ›ã€‚ã‚¬ãƒ©ã‚±ãƒ¼ãƒ»ãƒ•ã‚£ãƒ«ãƒ ãƒ»ãƒ‡ã‚¸ã‚«ãƒ¡ãƒ»åˆæœŸã‚¹ãƒãƒ›ã®4ç¨®é¡ã‚’é¸ã¶ã ã‘ã€‚">
<meta name="twitter:image" content="https://ojapp.app/og/pastcamera-og.jpg">

<!-- ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- ICONS -->
<link rel="icon" type="image/png" sizes="16x16" href="/icon/favicon-16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/icon/favicon-32.png">
<link rel="icon" type="image/png" sizes="48x48" href="/icon/favicon-48.png">
<link rel="apple-touch-icon" sizes="180x180" href="/icon/icon-180.png">

<meta name="theme-color" content="#2bb7ff">

<!-- DARKMODE -->
<script src="/darkmode.js" defer></script>
<style>

:root {
  --bg: #ffffff;
  --text: #222;
  --header-border: #eee;

  --section-bg: #ffffff;
  --section-shadow: rgba(0, 0, 0, .05);

  --input-bg: #ffffff;
  --input-border: #ddd;

  --icon-bg: #f5f5f5;

  --assistant-bg: #ffffff;
  --assistant-border: #2bb7ff;

   --sub: #9a9aa0;
  --accent: #F3F4F6;
  --an: #222;
}

/* ===== Dark Mode ===== */
.dark {
  --bg: #111;
  --text: #eaeaea;
  --header-border: #444;

  --section-bg: #1a1a1a;
  --section-shadow: rgba(0, 0, 0, .4);

  --input-bg: #222;
  --input-border: #555;

  --icon-bg: #2a2a2a;

  --assistant-bg: #111;
  --assistant-border: #67c8ff;

  --accent: #1a1a1f;
  --an: #ffffff;
}


/* =========================================
   Base
========================================= */
html, body {
  margin: 0;
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
  font-family: "Helvetica","Arial","YuGothic",sans-serif;
  background: var(--bg);
  color: var(--text);
  box-sizing: border-box;
}

*, *:before, *:after {
  box-sizing: inherit;
}

.center {
  width: 100%;
  max-width: 500px;
  margin: 0 auto;
  text-align: center;
}

.header {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 58px;
  padding: 0 16px;
  border-bottom: 1px solid var(--header-border);
}

.logo-link {
  display: flex;
  align-items: center;
  gap: 6px;
  text-decoration: none;
  color: inherit;
}

.logo-img {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  object-fit: cover;
}

.logo-text {
  font-size: 22px;
  font-weight: bold;
  line-height: 1;
  position: relative;
  top: 1px;
}

.switch {
  font-size: 24px;
  cursor: pointer;
}

main {
  width: 100%;
  max-width: 420px;
  padding: 28px 20px 40px;
}

/* ===== Header ===== */
main h1 {
  font-size: 26px;
  margin: 0;
  letter-spacing: 0.04em;
}

main p {
  margin: 6px 0 28px;
  font-size: 13px;
  color: var(--txet);
}

/* ===== Upload ===== */
.upload {
  background: var(--accent);
  border-radius: 16px;
  padding: 24px;
  text-align: center;
  cursor: pointer;
}

.upload input {
  display: none;
}

.upload span {
  font-size: 14px;
  color: var(--txet);
}

/* ===== Era Select ===== */
.eras {
  display: grid;
  gap: 12px;
  margin: 28px 0;
}

.era {
  background: var(--accent);
  border-radius: 14px;
  padding: 16px;
  cursor: pointer;
  border: 1px solid transparent;
}

.era.active {
  border-color: var(--sub);
}

.era strong {
  font-size: 15px;
}

.era small {
  display: block;
  margin-top: 4px;
  font-size: 12px;
  color: var(--sub);
}

/* ===== Save ===== */
button {
  width: 100%;
  padding: 16px;
  border-radius: 999px;
  border: none;
  background: var(--an);
  color: var(--bg);
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
}

/* ===== Result ===== */
.result {
  margin-top: 20px;
  font-size: 13px;
  color: var(--text);
  text-align: center;
}
  .previewImage {
  max-width: 100%;
  border-radius: 12px;
  margin-top: 20px;
}
/* =========================================
   Breadcrumbï¼ˆãƒ‘ãƒ³ããšï¼‰
========================================= */
.breadcrumb {
  font-size: 14px;
  margin: 6px 0 14px;
  color: var(--text);
  opacity: 0.7;
  text-align: left;
  max-width:500px;
  margin-left: auto;
  margin-right: auto;
}

.breadcrumb a {
  color: var(--assistant-border);
  font-weight: bold;
  text-decoration: none;
}

.breadcrumb a:hover {
  text-decoration: underline;
}
</style>
</head>

<body>
  <header class="header">
  <a href="/" class="logo-link">
    <img src="/icon/ojapp-logo.png?v=4" class="logo-img" alt="OJapp">
    <span class="logo-text">OJapp</span>
  </a>
  <div class="switch" onclick="toggleTheme()">ğŸ¤©</div>
</header>
<main>
 <nav class="breadcrumb">
    <a href="/">OJapp</a> â€ºÂ 
    <span>pastcamera</span>
  </nav>

  <h1>PastCamera</h1>
  <p>å†™çœŸã‚’ã€éå»ã®ã‚µã‚¤ã‚ºã«ã€‚</p>


<label class="upload">
  <input type="file" id="photoInput" accept="image/*">
  <span>å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
</label>
<div id="fileName"></div>
<section class="eras">
  <div class="era active" data-mode="garake">
    <strong>ã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡</strong>
    <small>ä¸€ç¬ã§â€œæ˜”ã®å†™ãƒ¡â€ã«ãªã‚‹ä½ç”»è³ªæ„Ÿ</small>
  </div>

  <div class="era" data-mode="film">
    <strong>ãƒ•ã‚£ãƒ«ãƒ </strong>
    <small>è‰²ã®æŠœã‘æ–¹ãŒç¾ã—ã„ã€ã‚¨ãƒ¢ã„ãƒ•ã‚£ãƒ«ãƒ è‰²</small>
  </div>

  <div class="era" data-mode="digicam">
    <strong>ãƒ‡ã‚¸ã‚«ãƒ¡</strong>
    <small>å½“æ™‚ã®ã‚³ãƒ³ãƒ‡ã‚¸ç‰¹æœ‰ã®å°‘ã—ã‚¶ãƒ©ã¤ãè³ªæ„Ÿ</small>
  </div>

  <div class="era" data-mode="smartphone">
    <strong>åˆæœŸã‚¹ãƒãƒ›</strong>
    <small>æ˜ã‚‹ãé’å¼·ã‚ãƒ»åˆæœŸiPhoneã®å†™ã‚Š</small>
  </div>
</section>


<button>ç”»åƒã‚’ä¿å­˜</button>

<div class="result">
  ã‚ã®é ƒã®å†™çœŸãŒã‚ˆã¿ãŒãˆã‚‹ã€€â–¼
</div>
<img id="output" class="previewImage">


<h1>PastCameraï½œå†™çœŸã‚’ã‚¬ãƒ©ã‚±ãƒ¼ãƒ»ãƒ•ã‚£ãƒ«ãƒ ãƒ»ãƒ‡ã‚¸ã‚«ãƒ¡é¢¨ã«åŠ å·¥ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«</h1>

<p>
PastCameraï¼ˆãƒ‘ã‚¹ãƒˆã‚«ãƒ¡ãƒ©ï¼‰ã¯ã€ã‚ãªãŸã®å†™çœŸã‚’ã€Œæ˜”ã®ã‚«ãƒ¡ãƒ©ã§æ’®ã£ãŸã‚ˆã†ãªå†™ã‚Šã€ã«ä¸€ç¬ã§å¤‰æ›ã§ãã‚‹ç„¡æ–™Webãƒ„ãƒ¼ãƒ«ã§ã™ã€‚  
ã‚¢ãƒ—ãƒªä¸è¦ãƒ»ç™»éŒ²ä¸è¦ã§ã€å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã ã‘ã€‚  
ã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡ã€ãƒ•ã‚£ãƒ«ãƒ ã€ãƒ‡ã‚¸ã‚«ãƒ¡ã€åˆæœŸã‚¹ãƒãƒ›ã®4ç¨®é¡ã‹ã‚‰é¸ã‚“ã§åŠ å·¥ã§ãã¾ã™ã€‚
  å®¹é‡ã‚’å°ã•ãã—ã¦ã‚‹ã‹ã‚‰ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®åœ§è¿«ã‚‚è»½æ¸›ã—ã¾ã™ã€‚
</p>

<h2>ğŸ•° PastCamera ã§å†ç¾ã§ãã‚‹ 4ã¤ã®æ™‚ä»£</h2>

<h3>â‘  ã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡ï¼ˆã€œ2008ï¼‰</h3>
<p>
å®¹é‡10ã€œ30KBã€ç™½ã£ã½ãç²—ã„ç‹¬ç‰¹ã®å†™ã‚Šã‚’å†ç¾ã€‚  
ã€Œæ˜”ã®å†™ãƒ¡æ„Ÿã€ã‚’ãã®ã¾ã¾å†ç¾ã—ãŸã„äººã«æœ€é©ã§ã™ã€‚
</p>

<h3>â‘¡ ãƒ•ã‚£ãƒ«ãƒ ï¼ˆ1990ã€œ2000å¹´ä»£ï¼‰</h3>
<p>
é’ãŒæ·¡ãã€é»„å‘³ãŒå°‘ã—ã®ã£ãŸæœ¬ç‰©ã®ãƒ•ã‚£ãƒ«ãƒ ã‚«ãƒ©ãƒ¼ã«å¯„ã›ãŸä»•ä¸ŠãŒã‚Šã€‚  
ãƒã‚¹ã‚¿ãƒ«ã‚¸ãƒƒã‚¯ã§æ¸©ã‹ã„é›°å›²æ°—ãŒç‰¹å¾´ã§ã™ã€‚
</p>

<h3>â‘¢ ãƒ‡ã‚¸ã‚«ãƒ¡ï¼ˆ2005ã€œ2010ï¼‰</h3>
<p>
ç¡¬ã‚ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã€ã»ã‚“ã®å°‘ã—ã®è‰²ãƒ ãƒ©ã€é’ã®å¼·ã•ã€‚  
å½“æ™‚ã®ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒ‡ã‚¸ã‚«ãƒ¡ã®ã€Œã¡ã‚‡ã£ã¨ã‚¯ã‚»ã®ã‚ã‚‹å†™ã‚Šã€ã‚’ãƒªã‚¢ãƒ«ã«å†ç¾ã—ã¾ã™ã€‚
</p>

<h3>â‘£ åˆæœŸã‚¹ãƒãƒ›ï¼ˆ2012ã€œ2014ï¼‰</h3>
<p>
é’ãŒå¼·ãã¦æ˜ã‚‹ã„ã€iPhone4ã€œ6 æ™‚ä»£ã®å†™ã‚Šã«å¯„ã›ãŸåŠ å·¥ã€‚  
ç¾ä»£ã‚ˆã‚Šå°‘ã—æ·¡ãã€ã§ã‚‚ç¶ºéº—ã™ããªã„çµ¶å¦™ãªç”»è³ªã§ã™ã€‚
</p>

<h2>ğŸ“¸ ç‰¹å¾´</h2>
<ul>
  <li>ç„¡æ–™ãƒ»ç™»éŒ²ä¸è¦ãƒ»ã‚¢ãƒ—ãƒªä¸è¦ã§ä½¿ãˆã‚‹</li>
  <li>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã ã‘ã§å³å¤‰æ›</li>
  <li>å®¹é‡ã‚‚å½“æ™‚ã®ã‚«ãƒ¡ãƒ©ã«å¯„ã›ã¦è‡ªå‹•èª¿æ•´</li>
  <li>ã‚¹ãƒãƒ›ã‹ã‚‰ãã®ã¾ã¾ä¿å­˜å¯èƒ½</li>
  <li>å®Ÿéš›ã®è‰²èª¿ã‚’åˆ†æã—ãŸå†ç¾åº¦ã®é«˜ã„ä»•ä¸ŠãŒã‚Š</li>
</ul>

<h2>ğŸ”§ ã©ã†ã‚„ã£ã¦ä½¿ã†ã®ï¼Ÿ</h2>
<ol>
  <li>å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</li>
  <li>4ã¤ã®æ™‚ä»£ã‹ã‚‰å¥½ããªã‚‚ã®ã‚’é¸ã¶</li>
  <li>ã€Œç”»åƒã‚’ä¿å­˜ã€ã‚’æŠ¼ã™ã ã‘</li>
</ol>

<h2>ğŸ PastCamera ã¯ã“ã‚“ãªäººã«ãŠã™ã™ã‚</h2>
<ul>
  <li>æ‡ã‹ã—ã„é›°å›²æ°—ã®å†™çœŸã‚’ä½œã‚ŠãŸã„</li>
  <li>ãƒ•ã‚£ãƒ«ãƒ ã‚«ãƒ¡ãƒ©é¢¨ã«ã—ãŸã„ã‘ã©æœ¬ç‰©ã¯é«˜ã„</li>
  <li>SNSã§ãƒ¬ãƒˆãƒ­ãªæŠ•ç¨¿ã‚’ã—ãŸã„</li>
  <li>æ˜”ã®ã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡ã¿ãŸã„ã«ç²—ã„å†™çœŸã‚’ä½œã‚ŠãŸã„</li>
</ul>

<h2>ğŸ“ è£œè¶³ï¼šPastCamera ã®ã“ã ã‚ã‚Š</h2>
<p>
è‰²ã®é€€è‰²ã€é’ã®æŠœã‘æ„Ÿã€é»„å‘³ã€ç™½é£›ã³ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã®ç¡¬ã•ãªã©ã€  
ãã‚Œãã‚Œã®ã‚«ãƒ¡ãƒ©æ™‚ä»£ã®â€œç™–â€ã‚’æ‰‹ä½œæ¥­ã§ç ”ç©¶ã—ã€JSã§å†ç¾ã—ã¦ã„ã¾ã™ã€‚  
ã¨ãã«ãƒ•ã‚£ãƒ«ãƒ ã¨ãƒ‡ã‚¸ã‚«ãƒ¡ã®å·®ã¯ã€å®Ÿéš›ã®ä½œä¾‹ã‚’å‚è€ƒã«ã‹ãªã‚Šç´°ã‹ãèª¿æ•´ã—ã¦ã„ã¾ã™ã€‚
</p>

<h2>ğŸ”š PastCamera ã®åˆ©ç”¨ã¯ç„¡æ–™ã§ã™</h2>
<p>
åºƒå‘Šãªã—ãƒ»ç„¡æ–™ã§ä½¿ãˆã¾ã™ã€‚  
ãŠæ°—è»½ã«å†™çœŸã‚’ã‚¢ãƒƒãƒ—ã—ã¦éŠã‚“ã§ã¿ã¦ãã ã•ã„ã€‚
</p>

</main>
  <script>
let selectedPreset = "garake";
let originalImage = null;
let lastBlob = null;

/* ===== æ–°4ãƒ¢ãƒ¼ãƒ‰ ===== */
const PRESETS = {
  // =====================
  // â‘  ã‚¬ãƒ©ã‚±ãƒ¼ï¼ˆå†™ãƒ¡ï¼‰
  // =====================
  garake: {
    label: "ã‚¬ãƒ©ã‚±ãƒ¼å†™ãƒ¡",
    maxSize: 720,
    quality: 0.3,
    rshift: 3,
    gshift: -1,
    bshift: -6,
    fade: 0.10,
    mura: 6,
    blueDesat: 0.78,
    highlight: 240,
    exposure: -0.03,
  },

  // =====================
  // â‘¡ ãƒ•ã‚£ãƒ«ãƒ ï¼ˆPortra Ã— Superiaï¼‰
  // =====================
 film: {
   label: "ãƒ•ã‚£ãƒ«ãƒ ",
  maxSize: 900,
  quality: 0.65,

  // è‰²å‘³ãƒãƒ©ãƒ³ã‚¹
  rshift: 2,
  gshift: -3,      // ç·‘ã»ã‚“ã®å°‘ã—å‰Šã£ã¦é’ç·‘â†’é’ç°ã¸
  bshift: -14,     // é’ã®è‰²å‘³ã‚’ã•ã‚‰ã«æŠœãï¼ˆå¼·ã‚OKï¼‰

  // é’ã„ç©ºã‚’â€œç™½å¯„ã‚Šâ€ã«ã™ã‚‹3ç‚¹ã‚»ãƒƒãƒˆ
  blueDesat: 0.86, // å½©åº¦ã‚’è½ã¨ã™ï¼ˆãã™ã¾ã›ã‚‹ï¼‰
  blueLift: 12,    // æ˜ã‚‹ã•ã‚’ä¸Šã’ã‚‹ â†’ ç©ºãŒç™½ã«è¿‘ã¥ã
  blueFade: 0.12,  // è¿½åŠ ï¼šé’ã ã‘ãƒ•ã‚§ãƒ¼ãƒ‰ã•ã›ã‚‹è£œæ­£ï¼ˆå¾Œã§èª¬æ˜ï¼‰

  fade: 0.15,
  contrast: 0.95,
  highlight: 252,  // é›²ã‚’ç™½ã¸å¯„ã›ã‚‹
  mura: 2,
},


  // =====================
  // â‘¢ ãƒ‡ã‚¸ã‚«ãƒ¡ï¼ˆ2005ã€œ2010ï¼‰
  // =====================
  digicam: {
    label: "ãƒ‡ã‚¸ã‚«ãƒ¡",
    maxSize: 1200,
    quality: 0.70,
    rshift: -2,
    gshift: 1,
    bshift: -3,    // é’ã‚’æŠ‘ãˆã‚‹
    fade: 0.12,
    mura: 2,
    blueDesat: 0.95,
    highlight: 220, // æ˜ã‚‹ã•ä¿®æ­£
    exposure: -0.05, // å…¨ä½“ã‚’å°‘ã—æš—ã
    purpleShift: 0.05, // ãƒŸãƒ‹ãƒã‚¼ãƒ³ã‚¿
  },

  // =====================
  // â‘£ åˆæœŸã‚¹ãƒãƒ›ï¼ˆiPhone4ã€œ6ï¼‰
  // =====================
  smartphone: {
    label: "åˆæœŸã‚¹ãƒãƒ›",
    maxSize: 1200,
    quality: 0.75,
    rshift: 2,
    gshift: 0,
    bshift: 2,
    fade: 0.06,
    mura: 2,
    blueDesat: 1.01, // é’ã‚’å¼±ã
    contrast: 1.02,    // â—€ ç¾ä»£å¯„ã‚Šã«å„ªã—ã‚ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ
  highlight: 245,
  }
};



/* ===== DOM ===== */
const fileInput = document.getElementById("photoInput");
const eraEls = document.querySelectorAll(".era");
const saveBtn = document.querySelector("button");
const resultEl = document.querySelector(".result");
const previewImg = document.getElementById("output");
const nameBox = document.getElementById("fileName");

/* ===== ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠæ™‚ï¼šãƒ•ã‚¡ã‚¤ãƒ«åè¡¨ç¤º + originalImage èª­ã¿è¾¼ã¿ ===== */
fileInput.addEventListener("change", e => {
  if (!fileInput.files.length) return;

  nameBox.textContent = "ğŸ“‚ " + fileInput.files[0].name;

  const img = new Image();
  img.onload = () => {
    originalImage = img;
    resultEl.textContent = "å†™çœŸã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ";
    generatePreview();  // â† å†™çœŸã‚’é¸ã‚“ã ç¬é–“ã«ã€ä»Šé¸ã°ã‚Œã¦ã‚‹ãƒ—ãƒªã‚»ãƒƒãƒˆã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
  };
  img.src = URL.createObjectURL(fileInput.files[0]);
});

/* ===== å¹´ä»£ï¼ˆãƒ¢ãƒ¼ãƒ‰ï¼‰é¸æŠ ===== */
eraEls.forEach(el => {
  el.addEventListener("click", () => {
    eraEls.forEach(e => e.classList.remove("active"));
    el.classList.add("active");
    selectedPreset = el.dataset.mode;  // â† ã“ã“ãŒæ–°ã—ããªã‚‹ï¼
    generatePreview();
  });
});


/* ===== ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆï¼ˆä¿å­˜å‰ã®åŠ å·¥ã™ã¹ã¦ã“ã“ã§ã‚„ã‚‹ï¼‰ ===== */
async function generatePreview() {
  if (!originalImage) return;

  const p = PRESETS[selectedPreset];
  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d");

  /* ãƒªã‚µã‚¤ã‚º */
  const scale = Math.min(
    p.maxSize / originalImage.width,
    p.maxSize / originalImage.height,
    1
  );
  canvas.width = originalImage.width * scale;
  canvas.height = originalImage.height * scale;

  ctx.drawImage(originalImage, 0, 0, canvas.width, canvas.height);

  const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
  const d = imgData.data;
  const set = PRESETS[selectedPreset];

  for (let i = 0; i < d.length; i += 4) {

/* ---- è‰²è»¢ã³ï¼ˆå„ãƒ¢ãƒ¼ãƒ‰å…±é€šã®åŸºç¤ï¼‰ ---- */
d[i]     += set.rshift;
d[i + 1] += set.gshift;
d[i + 2] += set.bshift;

/* ---- é’ã®å¼·ã•è£œæ­£ ---- */
d[i + 2] *= set.blueDesat;

/* ---- ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆï¼ˆç°¡æ˜“ç‰ˆï¼‰ ---- */
const avg = (d[i] + d[i+1] + d[i+2]) / 3;
d[i]     = d[i]     * (1 - set.fade) + avg * set.fade;
d[i + 1] = d[i + 1] * (1 - set.fade) + avg * set.fade;
d[i + 2] = d[i + 2] * (1 - set.fade) + avg * set.fade;

/* ---- ç²’å­ï¼ˆãƒ ãƒ©ï¼‰ ---- */
const m = (Math.random() - 0.5) * set.mura;
d[i]     += m;
d[i + 1] += m;
d[i + 2] += m;

/* ---- ç™½é£›ã³æŠ‘åˆ¶ ---- */
d[i]     = Math.min(d[i], set.highlight);
d[i + 1] = Math.min(d[i + 1], set.highlight);
d[i + 2] = Math.min(d[i + 2], set.highlight);

}

  ctx.putImageData(imgData, 0, 0);

  /* ===== ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º + ä¿å­˜ç”¨Blobç¢ºä¿ ===== */
  canvas.toBlob(blob => {
    lastBlob = blob;

    const url = URL.createObjectURL(blob);
    previewImg.src = url;

    const sizeKB = Math.round(blob.size / 1024);
    resultEl.innerHTML = `${p.label} ã®å†™çœŸã§ã™ï¼ˆ${sizeKB}KBï¼‰`;
}, "image/jpeg", p.quality);
}

/* ===== ä¿å­˜ãƒœã‚¿ãƒ³ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ¸ˆã¿ã® blob ã‚’ä¿å­˜ ===== */
saveBtn.addEventListener("click", () => {
  if (!lastBlob) {
    alert("å†™çœŸã‚’é¸ã‚“ã§ãã ã•ã„");
    return;
  }

  const a = document.createElement("a");
  a.href = URL.createObjectURL(lastBlob);
  a.download = "pastcamera.jpg";
  a.click();
});

  </script>
  <!-- FOOTER -->
<div id="footer"></div>
<script>
fetch("/footer.html")
  .then(r => r.text())
  .then(html => document.getElementById("footer").innerHTML = html);
</script>
</body>
</html>
