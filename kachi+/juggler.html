<div class="header">
  <button class="back-btn" onclick="location.href='index.html'">←</button>
  <div class="machine-name" id="machineName">読み込み中…</div>

  <div class="total-games">G数：<span id="totalGames">0</span></div>
</div>

<div class="games-input">
  総回転数：
  <input type="number" id="inputGames" placeholder="0" oninput="updateGames()">
</div>

<div class="counter-area">

  <!-- ぶどう -->
  <div class="counter-block grape">
    <div class="label">ぶどう</div>
    <button class="count-btn" onclick="addGrape()">+1</button>
    <div class="count-display">
      回数：<span id="grapeCount">0</span><br>
      確率：<span id="grapeRate">1/0</span>
    </div>
  </div>

  <!-- BIG REG -->
  <div class="bonus-row">

    <div class="counter-block big">
      <div class="label">BIG</div>
      <button class="count-btn" onclick="addBig()">+1</button>
      <div class="count-display">回数：<span id="bigCount">0</span></div>
    </div>

    <div class="counter-block reg">
      <div class="label">REG</div>
      <button class="count-btn" onclick="addReg()">+1</button>
      <div class="count-display">回数：<span id="regCount">0</span></div>
    </div>

  </div>

</div>

<div class="result-area">
  <div class="result">BIG：<span id="bigRate">1/0</span></div>
  <div class="result">REG：<span id="regRate">1/0</span></div>
  <div class="result">合算：<span id="totalRate">1/0</span></div>
  <div class="result">ぶどう：<span id="grapeRate2">1/0</span></div>
</div>

<div class="footer">
  <button class="footer-btn reset" onclick="resetAll()">リセット</button>
  <button class="footer-btn analyze" onclick="location.href='analyze.html'">設定期待度 ▶</button>
</div>
<script>
let grape = 0;
let big = 0;
let reg = 0;
let totalGames = 0;

  const machineMaster = {
  "im_juggler": "アイムジャグラーEX",
  "neo_im_juggler": "ネオアイムジャグラーEX",
  "myj5": "マイジャグラーV",
  "funky2": "ファンキージャグラー2",
  "gogo3": "ゴーゴージャグラー3",
  "happyv3": "ハッピージャグラーVⅢ",
  "girlss": "ジャグラーガールズSS",
  "mrj": "ミスタージャグラー",
  "umj": "ウルトラミラクルジャグラー"
};

  function initMachine() {
  const id = getQueryID();
  const name = machineMaster[id];

  // 不正アクセスや直打ち対策
  if (!name) {
    document.getElementById("machineName").innerText = "機種が見つかりません";
    return;
  }

  document.getElementById("machineName").innerText = name;
}

// -------------------------------
// 入力（総回転数）
// -------------------------------
function updateGames() {
  const val = parseInt(document.getElementById("inputGames").value || 0);
  totalGames = val;
  render();
}

// -------------------------------
// カウント
// -------------------------------
function addGrape() {
  grape++;
  render();
}

function addBig() {
  big++;
  render();
}

function addReg() {
  reg++;
  render();
}

// -------------------------------
// リセット
// -------------------------------
function resetAll() {
  grape = 0;
  big = 0;
  reg = 0;
  totalGames = 0;
  document.getElementById("inputGames").value = "";
  render();
}

// -------------------------------
// 計算処理
// -------------------------------
function rate(count, games) {
  if (count === 0 || games === 0) return "1/0";
  return "1/" + (games / count).toFixed(2);
}

function totalBonusRate() {
  const t = big + reg;
  if (t === 0 || totalGames === 0) return "1/0";
  return "1/" + (totalGames / t).toFixed(2);
}

// -------------------------------
// 画面反映
// -------------------------------
function render() {
  // カウンタ表示
  document.getElementById("grapeCount").innerText = grape;
  document.getElementById("bigCount").innerText = big;
  document.getElementById("regCount").innerText = reg;

  // 総回転数
  document.getElementById("totalGames").innerText = totalGames;

  // 確率計算
  document.getElementById("grapeRate").innerText = rate(grape, totalGames);
  document.getElementById("grapeRate2").innerText = rate(grape, totalGames);
  document.getElementById("bigRate").innerText = rate(big, totalGames);
  document.getElementById("regRate").innerText = rate(reg, totalGames);
  document.getElementById("totalRate").innerText = totalBonusRate();
}


  window.onload = function() {
  initMachine();
  render();   // ← カチカチ初期表示（あなたの既存関数）
};

render();
</script>
